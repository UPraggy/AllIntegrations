const express=require("express"),app=express();var x=require("x-ray")();app.set("view engine","pug"),app.set("views",__dirname),app.get("/LiturgiaDiaria",((e,i)=>{setTimeGet(e,i)})),app.get("/",((e,i)=>{i.send("NADA AQUI")}));const port=process.env.PORT||3e3;function setTimeGet(e,i){for(let r=0;r<2;r++)return 0!=r?void setTimeout((()=>getLiturgy(e,i)),1500):void getLiturgy(e,i)}async function getLiturgy(e,i){x("https://liturgia.cancaonova.com/pb/",{corLiturgica:".cor-liturgica",titulo:".entry-title",primeiraLeitura:"#liturgia-1",salmo:"#liturgia-2",evangelho:"#liturgia-4"})((function(e,r){if(Object.keys(r).forEach(((e,i)=>{r[e]=r[e].replace(/[\t\r]/g,"")})),-1!=r.evangelho.indexOf("breve")){let e=r.evangelho.indexOf("breve");r.evangelho=r.evangelho.slice(2,e)}(r=formatBarraN(r)).primeiraLeitura=formatPrimeiraLeitura(r.primeiraLeitura),r.salmo=formatSalmo(r.salmo),r.evangelho=formatEvangelho(r.evangelho),r.corLiturgica=[r.corLiturgica.split(":")[1],r.titulo.split("|")[0]],i.send(r)}))}function formatPrimeiraLeitura(e){e=e.split("\n");let i=[];return i[0]=e[0],i[1]=e[2],i[2]=e.slice(3).join("\n"),i[2]=i[2].split("Palavra do Senhor.")[0],i[2]=i[2].slice(0,-2),i}function formatSalmo(e){return(e=[(e=e.split("\n"))[0],e.slice(2)])[1]=e[1].join("\n"),e}function formatEvangelho(e){let i=e.split("\n")[0];for(e=(e=e.split("Glória a vós, Senhor")).slice(1).join("").slice(2);"\n"===e.slice(0,1);)e=e.slice(1);return e=[i,e=(e=e.split("Palavra da Salvação")[0]).slice(0,-3)]}function formatBarraN(e){return Object.keys(e).forEach(((i,r)=>{"corLiturgica"!=i&&(e[i]=e[i].slice(1))})),e}app.listen(port,(()=>console.log("server started")));
