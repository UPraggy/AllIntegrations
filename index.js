const express=require("express"),app=express();var x=require("x-ray")();app.set("view engine","pug"),app.set("views",__dirname),app.get("/LiturgiaDiaria",((e,r)=>{setTimeGet(e,r)})),app.get("/",((e,r)=>{r.send({"NADA AQUI":NADA AQUI})}));const port=process.env.PORT||3e3;function setTimeGet(e,r){for(let i=0;i<2;i++)return 0!=i?void setTimeout((()=>getLiturgy(e,r)),1500):void getLiturgy(e,r)}async function getLiturgy(e,r){x("https://liturgia.cancaonova.com/pb/",{corLiturgica:".cor-liturgica",titulo:".entry-title",primeiraLeitura:"#liturgia-1",salmo:"#liturgia-2",evangelho:"#liturgia-4"})((function(e,i){Object.keys(i).forEach(((e,r)=>{i[e]=i[e].replace(/[\t\r]/g,"")})),-1!=i.evangelho.indexOf("breve")&&(i.evangelho=i.evangelho.split("— Glória a vós, Senhor."),i.evangelho=i.evangelho[0],i.evangelho+="— Glória a vós, Senhor."),(i=formatBarraN(i)).primeiraLeitura=formatPrimeiraLeitura(i.primeiraLeitura),i.salmo=formatSalmo(i.salmo),i.evangelho=formatEvangelho(i.evangelho),i.corLiturgica=[i.corLiturgica.split(":")[1],i.titulo.split("|")[0]],r.send(i)}))}function formatPrimeiraLeitura(e){e=e.split("\n");let r=[];return r[0]=e[0],r[1]=e[2],r[2]=e.slice(3).join("\n"),r[2]=r[2].split("Palavra do Senhor.")[0],r[2]=r[2].slice(0,-2),r}function formatSalmo(e){return(e=[(e=e.split("\n"))[0],e.slice(2)])[1]=e[1].join("\n"),e}function formatEvangelho(e){let r=e.split("\n")[0];for((e=e.split("Glória a vós, Senhor.")).slice(1).length<5&&(e=e.join("").split("Glória a vós, Senhor!")),e=e.slice(1).join("");"\n"===e.slice(0,1);)e=e.slice(1);return e=[r,e=(e=e.split("Palavra da Salvação")[0]).slice(0,-3)]}function formatBarraN(e){return Object.keys(e).forEach(((r,i)=>{"corLiturgica"!=r&&(e[r]=e[r].slice(1))})),e}app.listen(port,(()=>console.log("server started")));
